==> Uncorrect: X shape = (8573, 50)
==> MyModel: X shape = (8573, 32)
==> Harmony: X shape = (8573, 50)
==> Scanorama: X shape = (8573, 50)
==> Seurat: X shape = (8573, 50)
ARI	NMI	ASW_celltype	ASW_batch	iLISI	KL
method						
Uncorrect	0.992935	0.982814	0.276393	0.423282	1.037214	1.060556
MyModel	0.934865	0.883899	0.324928	0.504472	2.598142	0.203261
Harmony	0.991184	0.979072	0.379519	0.502389	2.202659	0.368279
Scanorama	0.991998	0.980783	0.333851	0.427412	1.028713	1.065985
Seurat	0.992747	0.982005	0.389636	0.496848	1.915583	0.549426
保存: benchmark_out/metrics_summary.csv


                 scDML(louvain)
ARI                       0.987
NMI                       0.972
ASW_label                 0.920
ASW_label/batch           0.854
BatchKL                   0.690
cLISI                     1.000
iLISI                     1.752

Species	Tissue	Data Source	Batches	Dataset Dimensions

Mouse	Mammary epithelial cells	https://github.com/NBISweden/single-cell_sib_scilifelab/tree/master/datasets/SCE_MammaryEpithelial_x3.rds; (PumbedID_30089273, PubmedID_29158510, PubmedID_29225342)	3 batches	9288 cells 1222 genes

Macaque	Retina (Bipolar cells)	GSE11848(Peng et al., 2019)	2 regions
4 animals
30 samples	30302 cells
36162 genes

deepMNN 是一种基于互近邻策略的单细胞转录组批次校正方法。目前已经
有许多基于互近邻的批次校正方法被提出。MNNcorrect 是在原始特征空间搜索
互近邻对，有的方法首先使用特征提取方法对数据进行特征提取，然后在特征空
间中搜索互近邻对，例如 fastMNN、SMNN、Seurat 等。有的方法首先对细胞进
行聚类，然后在聚类的基础上搜索互近邻对，例如 Harmony、Scanorama 等。上
述方法中的特征提取和聚类都是为了提高搜索互近邻对的数量和搜索互近邻对
的准确性。而 deepMNN 自编码器结构能够在特征提取的同时对数据进行初步的
批次校正，从而提高搜索互近邻对的数量和准确性。

数据集细胞总数批次数测序技术
模拟数据集2000 2 Splatter(模拟工具)
人类血液树突状细胞768 2 Smart-Seq2
细胞系9530 3 10x Genomics
人类胰腺数据14767 5 inDrop、CEL-seq、CEL-seq2、Smart-seq2、Fluidigm C1
小鼠数据集100605 2 Smart-seq2、10x Genomics

人类血液树突状细胞数据集：采用密度梯度离心法从新鲜血液中分离外周血
单个核细胞。分别对 CD141 树突状细胞、pDC 浆细胞样树突状细胞、CD1C 树
突状细胞和双阴性细胞进行分类。使用 Smart-Seq2 协议对每个细胞群进行分析，
得到包含两个批次的数据集。第一批次数据包含树突状细胞、浆细胞样树突状细
胞、树突状细胞和双阴性细胞四种细胞类型，每种细胞类型有 96 个样本，总共
384 个细胞。第二批次数据同样包含树突状细胞、浆细胞样树突状细胞、树突状
细胞和双阴性细胞四种细胞类型，每种细胞类型有 96 个样本。该数据集的特点
是规模比较小，有些单细胞转录组数据批次校正方法不适用于校正规模较小的数
据集。除此了规模较小之外，该数据集中 CD141 细胞和 CD1C 细胞较为相似，
在对数据进行批次校正的同时容易将这两个相似的细胞类型错误的混合在一起。

细胞系数据集：该数据集由三个批次组成，第一个批次数据是仅由 293T 一
种细胞类型组成的数据，数据规模为 2885 个细胞。第二个批次数据集是仅由
Jurkat 一种细胞类型组成的数据集，数据规模为 3258 个细胞。第三个批次数据
是由 50%的 293T 细胞和 50%Jurkat 细胞混合组成的数据，数据规模为 3388 个细
胞。细胞系数据集是中等规模数据集，数据集中每种细胞类型的种群是单一的，
并且各细胞类型在生物学是特性不同，适用于评估批次效应校正。

人类胰腺数据集：由来自五个不同来源的人类胰腺数据构建。每个批次分别
使用不同协议进行测序，取每个批次数据基因特征的交集作为该数据集的基因特
征，最终该数据集包含五个批次数据，数据集规模为 14767 个细胞，包含 15558
个基因特征，13 种细胞类型。该数据集为中等规模数据集，包含五个批次，属于
批次数量较多的数据集，并且该数据集中包含批次独有的细胞类型，是一个较为
复杂的数据集。通过可视化分析，人类胰腺数据集不仅存在明显的批次效应，还
错误的把不同的细胞类型混合在了一起，这对单细胞转录组批次校正方法是一个
很大的挑战，需要对数据进行批次校正的同时正确的区分不同的细胞类型。

小鼠细胞数据集：分析了 7 只动物的 20 个不同器官和组织的 10 万多个细
胞，并且使用不同的测序技术方法获得了不同器官的数据。第一个批次使用
Smart-seq2 测序技术测量了 44949 个细胞，第二个批次使用 10x Genomics 测序
技术测量了 55656 个细胞。取这两个批次数据基因特征的交集，最终数据集包含
15006 个基因特征。小鼠细胞数据是一个规模较大且复杂的数据集，包含了不同
小鼠样本、不同的测序技术、不同组织或器官，不同的细胞类型。小鼠细胞数据
集揭示了许多新的生物学信息，例如细胞轨迹分析，细胞分化过程等生物过程。
对大规模数据集进行批次校正对批次校正方法是一个很大的挑战，不仅仅要考虑
批次校正的结果，还需要考虑批次校正的时间和所需要的其他计算资源。小鼠细
胞数据集不仅是规模较大，还包含了不同的组织和器官以及批次独有的细胞类型，
所以在对数据集进行批次校正时，可以进一步分析不同组织和器官间共享的细胞
类型的批次校正结果。
